<apex:page controller="VisitTypeExportController" showHeader="false" sidebar="false" renderAs="pdf" cache="false" applyBodyTag="false" applyHtmlTag="false">
    <html>
        <head>
            <style>
                body { font-family: 'Arial', sans-serif; font-size: 12px; color: #1b2d4f; }
                .wrapper { padding: 16px; }
                .title { font-size: 16px; font-weight: 700; margin-bottom: 12px; }
                .section-card { border: 1px solid #dfe3e8; border-radius: 6px; padding: 10px 12px; margin-bottom: 10px; background: #f9fafb; }
                .section-header { font-weight: 700; font-size: 13px; margin-bottom: 6px; }
                .row { display: table; width: 100%; table-layout: fixed; margin-bottom: 6px; }
                .cell-type { display: table-cell; width: 50%; font-size: 12px; }
                .cell-bar { display: table-cell; width: 40%; vertical-align: middle; }
                .cell-val { display: table-cell; width: 10%; text-align: right; font-weight: 700; }
                .bar-track { width: 100%; height: 10px; background: #e9eef5; border-radius: 6px; }
                .bar-fill { height: 10px; border-radius: 6px; background: #0284d0; background: linear-gradient(90deg, #0176d3 0%, #00a1e0 100%); }
                .muted { color: #5f6a7d; font-size: 11px; }
            </style>
        </head>
        <body>
            <div class="wrapper">
                <div class="title">Visite per Localit√† e Tipo</div>
                <apex:repeat value="{!sections}" var="s">
                    <div class="section-card">
                        <div class="section-header">{!s.label} <span class="muted">({!s.totalQty} visite)</span></div>
                        <apex:repeat value="{!s.rows}" var="r">
                            <div class="row">
                                <div class="cell-type">{!r.visitType}</div>
                                <div class="cell-bar">
                                    <div class="bar-track">
                                        <div class="bar-fill" style="width:{!r.percentOfMax}%"></div>
                                    </div>
                                </div>
                                <div class="cell-val">{!r.qty}</div>
                            </div>
                        </apex:repeat>
                    </div>
                </apex:repeat>
            </div>
        </body>
    </html>
</apex:page>