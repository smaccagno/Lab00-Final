<template>
    <lightning-card variant="base">
        <div slot="title" title="Accesso Strutture" class="slds-p-around_small slds-text-heading_medium">
            Offerte
        </div>

        <div slot="actions">
            <lightning-button label="Nuova Offerta" onclick={newTicket}></lightning-button>
            <c-export-to-excel if:true={data.length} json-data={jsonData} file-name="Offerte" button-label="Esporta"></c-export-to-excel>
            <lightning-button-icon onclick={refreshData} icon-name="utility:refresh" alternative-text="Ricarica" title="Ricarica" class="slds-m-left_x-small"></lightning-button-icon>
        </div>

        <hr class="slds-m-vertical_xxx-small">
    
        <div class="slds-p-around_small">
            <lightning-datatable 
                if:true={data.length}
                key-field="id" 
                data={data} 
                columns={columns}
                onrowaction={handleRowAction}
                onsort={handleSort}
                sorted-direction={sortDirection}
                sorted-by={sortedBy}
                hide-checkbox-column>
            </lightning-datatable>

            <div if:true={showWelcomeText} class="slds-text-align_center slds-text-heading_small slds-p-around_medium">
                <span class="slds-text-heading_large">Benvenuto!</span>
                <br/>
                <span>Non hai ancora creato nessuna offerta</span>
                <br/>
                <span>Crea la tua prima offerta cliccando sul pulsante "Nuova Offerta"</span>
            </div>

        </div>
    </lightning-card> 

    <!-- Modale con il Flow -->
    <template if:true={isModalOpen}>
        <c-site-flow-modal title={flowTitle} flow-name={flowName} input-variables={flowInputVariables} onclose={closeModal}></c-site-flow-modal>
    </template>
</template>